<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Báº¯n Thuyá»n - NhÃ³m 1 & NhÃ³m 2 (Quiz flow - Ocean Theme)</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@400;500;600;700;800&display=swap');

body {
    font-family: 'Be Vietnam Pro', sans-serif;
    height: 100vh;
    margin: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    position: relative;
    overflow: hidden;
    /* DÃ’NG NÃ€Y ÄÃƒ ÄÆ¯á»¢C THAY Äá»”I: Sá»­ dá»¥ng áº£nh ná»n */
    background: url('Light Blue Pirate Birthday Poster.png') no-repeat center center fixed;
    background-size: cover; 
    /* DÃ’NG NÃ€Y ÄÃƒ ÄÆ¯á»¢C THAY Äá»”I */
}

.container {
    display: flex;
    align-items: flex-start;
    justify-content: center;
    gap: 100px;
    position: relative;
    z-index: 5;
}

.divider {
    position: absolute;
    left: 50%;
    top: 0;
    bottom: 0;
    width: 2px;
    background: linear-gradient(to bottom, transparent, #9ac7e5, transparent);
    transform: translateX(-50%);
}

.board-container {
    display: flex;
    flex-direction: column;
    align-items: center;
}

h2 {
    margin-bottom: 20px;
    font-weight: 700;
    letter-spacing: 0.5px;
    font-size: 28px;
    text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
}

.board {
    display: grid;
    grid-template-columns: 45px repeat(5, 70px);
    grid-template-rows: 45px repeat(5, 70px);
    gap: 6px;
    background: #cde8f8;
    padding: 20px;
    border-radius: 25px;
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.25);
}

.label {
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 18px;
    font-weight: 700;
    color: #444;
}

.cell {
    background: white;
    border-radius: 12px;
    cursor: pointer;
    transition: all 0.16s ease;
    display:flex;
    align-items:center;
    justify-content:center;
    font-size:26px;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    font-weight: 800;
    position: relative;
}

.cell:hover {
    transform: scale(1.05);
    box-shadow: 0 6px 15px rgba(0, 0, 0, 0.25);
}

/* Tráº¡ng thÃ¡i Ã´ Ä‘Ã£ tráº£ lá»i quiz */
.cell[data-answered="true"] {
    cursor: pointer;
    background: white !important;
}
.cell[data-answered="true"]:hover {
    transform: scale(1.05);
}

/* Dáº¥u trÃ²n trÃºng/trÆ°á»£t */
.cell.hit::before, .cell.miss::before {
    content: '';
    position: absolute;
    width: 40px;
    height: 40px;
    border-radius: 50%;
    z-index: 2;
    box-shadow: 0 1px 4px rgba(0, 0, 0, 0.4);
}
.cell.hit::before { background: #b30000; }
.cell.miss::before { background: #0056cc; }
.cell.hit, .cell.miss {
    background: white !important;
    color: transparent;
}

/* Popup chá»n mÃ u */
.popup {
    position: absolute;
    background: white;
    border-radius: 15px;
    padding: 15px;
    display: flex;
    gap: 15px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.3);
    z-index: 10;
}
.color-btn {
    width: 35px;
    height: 35px;
    border-radius: 50%;
    border: none;
    cursor: pointer;
    box-shadow: 0 2px 6px rgba(0,0,0,0.3);
}
.color-btn.red { background: #b30000; }
.color-btn.blue { background: #0056cc; }

/* Quiz overlay */
.quiz-popup {
    position: fixed;
    inset: 0;
    display: none;
    align-items: center;
    justify-content: center;
    background: rgba(0,0,0,0.6);
    z-index: 50;
}
.quiz-box {
    width: 550px;
    background: #fff9f3;
    border-radius: 25px;
    padding: 40px;
    box-shadow: 0 15px 40px rgba(0,0,0,0.5);
    text-align:center;
    transition: transform 0.1s ease-in-out;
}
@keyframes shake-and-celebrate {
    0% { transform: scale(1) rotate(0deg); }
    20% { transform: scale(1.04) rotate(-1.5deg); }
    40% { transform: scale(1.04) rotate(1.5deg); }
    60% { transform: scale(1.04) rotate(-1.5deg); }
    80% { transform: scale(1.04) rotate(1.5deg); }
    100% { transform: scale(1) rotate(0deg); }
}
.quiz-box.celebrate {
    animation: shake-and-celebrate 0.5s;
}
.quiz-question {
    font-weight: 700;
    margin-bottom: 30px;
    font-size: 22px;
    text-align: justify;
    line-height: 1.5;
}
.option {
    background: #f0e2d2;
    padding: 18px;
    border-radius: 15px;
    margin: 12px 0;
    cursor: pointer;
    transition: 0.14s;
    text-align: left;
    font-size: 18px;
    font-weight: 500;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}
.option:hover { 
    transform: translateY(-3px);
    background: #e0d2c2;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
}
.option.correct {
    background: #d4f5d6;
    border: 3px solid #8cd179;
    font-weight: 700;
}
.option.wrong {
    background: #ffd7d7;
    border: 3px solid #ff7b7b;
    font-weight: 700;
}
.fitb-input {
    width: 90%;
    padding: 15px;
    margin: 20px 0;
    border: 3px solid #ccc;
    border-radius: 12px;
    font-size: 20px;
    text-align: center;
    font-weight: 600;
}
.fitb-feedback {
    margin-top: 25px;
    font-weight: 800;
    font-size: 26px;
    display: block;
}
.fitb-btn {
    padding: 15px 30px;
    border: none;
    border-radius: 12px;
    background: #0056cc;
    color: white;
    cursor: pointer;
    margin-top: 20px;
    transition: 0.14s;
    font-weight: 700;
    font-size: 20px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
}
.fitb-btn:hover { background: #0044a0; }

.back-btn {
    padding: 15px 30px;
    border: none;
    border-radius: 12px;
    background: #6c757d;
    color: white;
    cursor: pointer;
    margin-top: 30px;
    font-size: 20px;
    font-weight: 700;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
    transition: background 0.14s;
}
.back-btn:hover { background: #5a6268; }
</style>
</head>
<body>
    <div class="container">
        <div class="divider"></div>
        <div class="board-container">
            <h2 style="color:#b30000">Báº¢NG NHÃ“M 1</h2>
            <div class="board" id="board1"></div>
        </div>
        <div class="board-container">
            <h2 style="color:#0056cc">Báº¢NG NHÃ“M 2</h2>
            <div class="board" id="board2"></div>
        </div>
    </div>

    <div id="popup" class="popup" style="display:none;">
        <button class="color-btn red" title="ÄÃ¡nh dáº¥u TrÃºng"></button>
        <button class="color-btn blue" title="ÄÃ¡nh dáº¥u TrÆ°á»£t"></button>
    </div>

    <div id="quizPopup" class="quiz-popup">
        <div id="quizBox" class="quiz-box" role="dialog" aria-modal="true">
            <div id="quizQuestion" class="quiz-question"></div>
            <div id="quizContent"></div>
            <button id="backBtn" class="back-btn">Quay láº¡i báº£ng</button>
        </div>
    </div>

<script>
/* --- DATA CÃ‚U Há»I Tá»”NG Há»¢P --- */

const officialQuestions = [
    // 37 cÃ¢u há»i tá»« Ä‘á» bÃ i trÆ°á»›c
    // 1
    { type: 'mc', q: "Äáº¡i há»™i VII rÃºt ra Ä‘Æ°á»£c bao nhiÃªu bÃ i há»c tá»« Ä‘áº¡i há»™i trÆ°á»›c Ä‘Ã³?", options: ["3","4","5","6"], ans: 2 },
    // 2
    { type: 'mc', q: "Nhiá»‡m vá»¥ nÃ o sau Ä‘Ã¢y Ä‘Æ°á»£c nÃªu ra trong Äáº¡i há»™i VII?", options: ["BÆ°á»›c Ä‘áº§u á»•n Ä‘á»‹nh vÃ  tá»«ng bÆ°á»›c cáº£i thiá»‡n Ä‘á»i sá»‘ng váº­t cháº¥t vÃ  vÄƒn hoÃ¡ cá»§a nhÃ¢n dÃ¢n lao Ä‘á»™ng.","Cáº§n kiá»‡m Ä‘á»ƒ cÃ´ng nghiá»‡p hoÃ¡, kháº¯c phá»¥c xu hÆ°á»›ng cháº¡y theo â€œxÃ£ há»™i tiÃªu dÃ¹ng\".","NÃ¢ng cao nÄƒng lá»±c lÃ£nh Ä‘áº¡o, nÄƒng lá»±c cáº§m quyá»n vÃ  sá»©c chiáº¿n Ä‘áº¥u cá»§a Äáº£ng, xÃ¢y dá»±ng Äáº£ng vÃ  há»‡ thá»‘ng chÃ­nh trá»‹ trong sáº¡ch, vá»¯ng máº¡nh.", "PhÃ¡t huy quyá»n tá»± chá»§ trong sáº£n xuáº¥t kinh doanh cá»§a cÃ¡c xÃ­ nghiá»‡p quá»‘c doanh."], ans: 0 },
    // 3
    { type: 'mc', q: "Láº§n Ä‘áº§u tiÃªn Äáº£ng giÆ°Æ¡ng cao ngá»n cá» tÆ° tÆ°á»Ÿng Há»“ ChÃ­ Minh vÃ o Ä‘áº¡i há»™i nÃ o?", options: ["Äáº¡i há»™i VI (1986)","Äáº¡i há»™i VII (1991)","Äáº¡i há»™i VIII (1996)","Äáº¡i há»™i IX (2001)"], ans: 1 },
    // 4
    { type: 'mc', q: "Trong Há»™i nghá»‹ 4 Ä‘Ã£ ban hÃ nh 5 nghá»‹ quyáº¿t dá»±a trÃªn quan Ä‘iá»ƒm coi gÃ¬ lÃ  má»¥c tiÃªu pháº¥n Ä‘áº¥u cao nháº¥t cá»§a Äáº£ng?", options: ["Äá»™c láº­p cá»§a dÃ¢n tá»™c","Quyá»n tá»± do cá»§a con ngÆ°á»i","Äáº¥t nÆ°á»›c á»•n Ä‘á»‹nh vÃ  phÃ¡t triá»ƒn","Háº¡nh phÃºc cá»§a con ngÆ°á»i"], ans: 3 },
    // 5
    { type: 'mc', q: "Äáº¡i há»™i Äáº¡i biá»ƒu ToÃ n quá»‘c nÄƒm 1991 nháº¥n máº¡nh má»¥c tiÃªu tá»•ng quÃ¡t lÃ  gÃ¬?", options: ["VÆ°á»£t khÃ³ khÄƒn thá»­ thÃ¡ch, á»•n Ä‘á»‹nh vÃ  phÃ¡t triá»ƒn kinh táº¿ - xÃ£ há»™i, tÄƒng cÆ°á»ng á»•n Ä‘á»‹nh chÃ­nh trá»‹, Ä‘áº©y lÃ¹i tiÃªu cá»±c vÃ  báº¥t cÃ´ng xÃ£ há»™i, Ä‘Æ°a nÆ°á»›c ta cÆ¡ báº£n ra khá»i tÃ¬nh tráº¡ng khá»§ng hoáº£ng.","VÆ°á»£t khÃ³ khÄƒn thá»­ thÃ¡ch, xÃ¢y dá»±ng Ä‘áº¥t nÆ°á»›c cá»™ng sáº£n, tÄƒng cÆ°á»ng á»•n Ä‘á»‹nh chÃ­nh trá»‹, Ä‘áº©y lÃ¹i tiÃªu cá»±c vÃ  báº¥t cÃ´ng xÃ£ há»™i.","VÆ°á»£t khÃ³ khÄƒn thá»­ thÃ¡ch, xÃ¢y dá»±ng Ä‘áº¥t nÆ°á»›c cá»™ng sáº£n, á»•n Ä‘á»‹nh vÃ  phÃ¡t triá»ƒn kinh táº¿ - xÃ£ há»™i, tÄƒng cÆ°á»ng á»•n Ä‘á»‹nh chÃ­nh trá»‹, Ä‘áº©y lÃ¹i tiÃªu cá»±c vÃ  báº¥t cÃ´ng xÃ£ há»™i, Ä‘Æ°a nÆ°á»›c ta cÆ¡ báº£n ra khá»i tÃ¬nh tráº¡ng khá»§ng hoáº£ng.","VÆ°á»£t khÃ³ khÄƒn thá»­ thÃ¡ch, á»•n Ä‘á»‹nh vÃ  phÃ¡t triá»ƒn kinh táº¿ - xÃ£ há»™i, tÄƒng cÆ°á»ng á»•n Ä‘á»‹nh chÃ­nh trá»‹, Ä‘Æ°a Ä‘áº¥t nÆ°á»›c tiáº¿n Ä‘áº¿n phÃ¡t triá»ƒn nÃ´ng nghiá»‡p."], ans: 0 },
    // 6
    { type: 'mc', q: "Äáº¡i há»™i VII cá»§a Äáº£ng lÃ :", options: ["â€œÄáº¡i há»™i cá»§a sÃ¡ng táº¡o - Ä‘á»•i má»›i - dÃ¢n chá»§ - ká»· cÆ°Æ¡ng - Ä‘oÃ n káº¿t\"","â€œÄáº¡i há»™i cá»§a trÃ­ tuá»‡ - Ä‘á»•i má»›i - dÃ¢n chá»§ - ká»· cÆ°Æ¡ng - Ä‘oÃ n káº¿t\"","â€œÄáº¡i há»™i cá»§a sÃ¡ng táº¡o - phÃ¡t triá»ƒn - dÃ¢n chá»§ - ká»· cÆ°Æ¡ng - Ä‘oÃ n káº¿tâ€","â€œÄáº¡i há»™i cá»§a trÃ­ tuá»‡ - phÃ¡t triá»ƒn - dÃ¢n chá»§ - ká»· cÆ°Æ¡ng - Ä‘oÃ n káº¿t\""], ans: 1 },
    // 7
    { type: 'fitb', q: "Äáº£ng láº¥y chá»§ nghÄ©a MÃ¡c - LÃªnin vÃ  tÆ° tÆ°á»Ÿng Há»“ ChÃ­ Minh lÃ m \_\_\_\_\_ cho hÃ nh Ä‘á»™ng.", correctAnswer: "ná»n táº£ng tÆ° tÆ°á»Ÿng, kim chá»‰ nam" },
    // 8
    { type: 'mc', q: "Viá»‡t Nam vÃ  Trung Quá»‘c thiáº¿t láº­p láº¡i vÃ  bÃ¬nh thÆ°á»ng hÃ³a má»‘i quan há»‡ giá»¯a 2 nÆ°á»›c vÃ o thá»i gian nÃ o?", options: ["2/1991","7/1991","10/1991","11/1991"], ans: 3 },
    // 9
    { type: 'mc', q: "Viá»‡t Nam vÃ  Hoa Ká»³ thiáº¿t láº­p láº¡i quan há»‡ ngoáº¡i giao vÃ o nÄƒm nÃ o?", options: ["1993","1995","1997","2001"], ans: 1 },
    // 10
    { type: 'mc', q: "BCH Trung Æ°Æ¡ng Äáº¡i há»™i VII ra chá»‰ Ä‘áº¡o Ä‘á»•i má»›i toÃ n diá»‡n, trong Ä‘Ã³ coi Ä‘Ã¢u lÃ  Máº·t tráº­n hÃ ng Ä‘áº§u?", options: ["CÃ´ng nghiá»‡p","NÃ´ng nghiá»‡p","ThÆ°Æ¡ng nghiá»‡p","Cáº£ a, b, c"], ans: 1 },
    // 11
    { type: 'fitb', q: "â€œÄáº¡i há»™i VII lÃ  Äáº¡i há»™i cá»§a \_\_\_\_\_ dÃ¢n chá»§ - ká»· cÆ°Æ¡ng - Ä‘oÃ n káº¿t\"", correctAnswer: "trÃ­ tuá»‡ - Ä‘á»•i má»›i" },
    // 12
    { type: 'mc', q: "Äáº¡i há»™i Äáº£ng toÃ n quá»‘c láº§n thá»© VII Ä‘Ã£ thÃ´ng qua nhá»¯ng vÄƒn kiá»‡n nÃ o?", options: ["BÃ¡o cÃ¡o chÃ­nh trá»‹, bÃ¡o cÃ¡o tá»•ng káº¿t cÃ´ng tÃ¡c xÃ¢y dá»±ng Äáº£ng","CÆ°Æ¡ng lÄ©nh xÃ¢y dá»±ng Ä‘áº¥t nÆ°á»›c trong thá»i ká»³ quÃ¡ Ä‘á»™ lÃªn chá»§ nghÄ©a xÃ£ há»™i, Chiáº¿n lÆ°á»£c á»•n Ä‘á»‹nh vÃ  phÃ¡t triá»ƒn kinh táº¿ - xÃ£ há»™i Ä‘áº¿n nÄƒm 2000","BÃ¡o cÃ¡o chÃ­nh trá»‹, nghá»‹ quyáº¿t vá» nhiá»‡m vá»¥ vÃ  Ä‘Æ°á»ng lá»‘i cá»§a Äáº£ng trong giai Ä‘oáº¡n má»›i","PhÆ°Æ¡ng hÆ°á»›ng, nhiá»‡m vá»¥, káº¿ hoáº¡ch phÃ¡t triá»ƒn kinh táº¿-xÃ£ há»™i 5 nÄƒm 1996-2000, Äiá»u lá»‡ Äáº£ng (bá»• sung, sá»­a Ä‘á»•i)"], ans: 1 },
    // 13
    { type: 'mc', q: "Ná»™i dung nÃ o khÃ´ng cÃ³ trong Ä‘áº¡i há»™i Äáº£ng toÃ n quá»‘c láº§n thá»© VII?", options: ["XÃ¡c Ä‘á»‹nh 7 phÆ°Æ¡ng hÆ°á»›ng lá»›n xÃ¢y dá»±ng chá»§ nghÄ©a xÃ£ há»™i","Chá»‰ ra nhá»¯ng thÃ nh cÃ´ng, khuyáº¿t Ä‘iá»ƒm, sai láº§m trong hÆ¡n 60 nÄƒm lÃ£nh Ä‘áº¡o cá»§a Äáº£ng","NÃªu ra 6 bÃ i há»c chá»§ yáº¿u trong 10 nÄƒm Ä‘á»•i má»›i","ThÃ´ng qua â€œchiáº¿n lÆ°á»£c á»•n Ä‘á»‹nh vÃ  phÃ¡t triá»ƒn kinh táº¿ - xÃ£ há»™i Ä‘áº¿n nÄƒm 2000\""], ans: 2 },
    // 14
    { type: 'mc', q: "Äiá»n tá»« cÃ²n thiáº¿u vÃ o chá»— trá»‘ng: â€œNghá»‹ quyáº¿t Äáº¡i há»™i VII cá»§a Äáº£ng Ä‘Ã£ Ä‘Æ°a ra quan Ä‘iá»ƒm coi ... lÃ  nhÃ¢n tá»‘ quyáº¿t Ä‘á»‹nh, lÃ  Ä‘á»™ng lá»±c to lá»›n, lÃ  chá»§ thá»ƒ sÃ¡ng táº¡o má»i nguá»“n cá»§a cáº£i, váº­t cháº¥t lÃ  tinh tháº§n cá»§a xÃ£ há»™i, lÃ  má»¥c tiÃªu pháº¥n Ä‘áº¥u cao nháº¥t cá»§a Äáº£ngâ€", options: ["NhÃ¢n dÃ¢n","Con ngÆ°á»i","Khoa há»c, ká»¹ thuáº­t","Kinh táº¿"], ans: 1 },
    // 15
    { type: 'mc', q: "Äiá»n tá»« cÃ²n thiáº¿u vÃ o chá»— trá»‘ng: â€œTrong há»‡ thá»‘ng chÃ­nh trá»‹, ...... lÃ  má»™t bá»™ pháº­n vÃ  lÃ  tá»• chá»©c lÃ£nh Ä‘áº¡o há»‡ thá»‘ng Ä‘Ã³, láº¥y Chá»§ nghÄ©a MÃ¡c - LÃªnin vÃ  TÆ° tÆ°á»Ÿng Há»“ ChÃ­ Minh lÃ m ná»n táº£ng tÆ° tÆ°á»Ÿng, kim chá»‰ nam cho hÃ nh Ä‘á»™ng, láº¥y ...... lÃ m nguyÃªn táº¯c tá»• chá»©c cÆ¡ báº£n.\"", options: ["NhÃ  nÆ°á»›c - Ä‘a sá»‘ tháº¯ng thiá»ƒu sá»‘","ChÃ­nh phá»§ - phÃª bÃ¬nh vÃ  tá»± phÃª bÃ¬nh","Äáº£ng Cá»™ng sáº£n - táº­p trung dÃ¢n chá»§","NhÃ¢n dÃ¢n - táº­p trung dÃ¢n chá»§"], ans: 2 },
    // 16
    { type: 'mc', q: "Chiáº¿n lÆ°á»£c á»•n Ä‘á»‹nh vÃ  phÃ¡t triá»ƒn kinh táº¿ - xÃ£ há»™i Ä‘áº¿n nÄƒm 2000 do Äáº¡i há»™i VII thÃ´ng qua nháº±m má»¥c tiÃªu gÃ¬?", options: ["BÃ¬nh á»•n xÃ£ há»™i, phÃ¡t triá»ƒn Ä‘áº¥t nÆ°á»›c, Ä‘Æ°a Ä‘áº¥t nÆ°á»›c thoÃ¡t ra khá»i khÃ³ khÄƒn","BÃ¬nh á»•n xÃ£ há»™i, phÃ¡t triá»ƒn Ä‘áº¥t nÆ°á»›c, Ä‘Æ°a Ä‘áº¥t nÆ°á»›c thoÃ¡t ra khá»i nghÃ¨o nÃ n","BÃ¬nh á»•n xÃ£ há»™i, phÃ¡t triá»ƒn Ä‘áº¥t nÆ°á»›c, Ä‘Æ°a Ä‘áº¥t nÆ°á»›c thoÃ¡t ra khá»i cáº¡nh tranh","BÃ¬nh á»•n xÃ£ há»™i, phÃ¡t triá»ƒn Ä‘áº¥t nÆ°á»›c, Ä‘Æ°a Ä‘áº¥t nÆ°á»›c thoÃ¡t ra khá»i kÃ©m phÃ¡t triá»ƒn"], ans: 0 },
    // 17
    { type: 'mc', q: "Quan há»‡ Ä‘á»‘i ngoáº¡i vÃ  há»™i nháº­p quá»‘c táº¿ cá»§a Viá»‡t Nam sau Äáº¡i há»™i VII cÃ³ nhá»¯ng Ä‘iá»ƒm gÃ¬?", options: ["NgÃ y cÃ ng sÃ¢u rá»™ng vÃ  toÃ n diá»‡n; vá»‹ tháº¿, uy tÃ­n cá»§a Viá»‡t Nam trÃªn trÆ°á»ng quá»‘c táº¿ Ä‘Æ°á»£c tÄƒng cÆ°á»ng.","NgÃ y cÃ ng toÃ n diá»‡n vÃ  sÃ¢u sáº¯c; vá»‹ tháº¿, uy tÃ­n cá»§a Viá»‡t Nam trÃªn trÆ°á»ng quá»‘c táº¿ Ä‘Æ°á»£c tÄƒng cÆ°á»ng.","NgÃ y cÃ ng sÃ¢u rá»™ng vÃ  hiá»‡u quáº£; vá»‹ tháº¿, uy tÃ­n cá»§a Viá»‡t Nam trÃªn trÆ°á»ng quá»‘c táº¿ Ä‘Æ°á»£c nÃ¢ng cao.","NgÃ y cÃ ng bá»n vá»¯ng vÃ  phÃ¡t triá»ƒn; vá»‹ tháº¿, uy tÃ­n cá»§a Viá»‡t Nam trÃªn trÆ°á»ng quá»‘c táº¿ Ä‘Æ°á»£c nÃ¢ng cao."], ans: 2 },
    // 18
    { type: 'mc', q: "Há»™i nghá»‹ Trung Æ°Æ¡ng 5 khÃ³a VII Ä‘Ã£ ban hÃ nh Nghá»‹ quyáº¿t nÃ o vá» tiáº¿p tá»¥c Ä‘á»•i má»›i vÃ  phÃ¡t triá»ƒn kinh táº¿ - xÃ£ há»™i nÃ´ng thÃ´n?", options: ["Nghá»‹ quyáº¿t sá»‘ 02-NQ/TW","Nghá»‹ quyáº¿t sá»‘ 03-NQ/TW","Nghá»‹ quyáº¿t sá»‘ 04-NQ/TW","Nghá»‹ quyáº¿t sá»‘ 05-NQ/TW"], ans: 3 },
    // 19
    { type: 'mc', q: "â€œXÃ¢y dá»±ng xong vá» cÆ¡ báº£n nhá»¯ng cÆ¡ sá»Ÿ kinh táº¿ cá»§a chá»§ nghÄ©a xÃ£ há»™i, vá»›i kiáº¿n trÃºc thÆ°á»£ng táº§ng vá» chÃ­nh trá»‹ vÃ  tÆ° tÆ°á»Ÿng, vÄƒn hÃ³a phÃ¹ há»£p, lÃ m cho nÆ°á»›c ta trá»Ÿ thÃ nh má»™t nÆ°á»›c xÃ£ há»™i chá»§ nghÄ©a phá»“n vinh lÃ :", options: ["Má»¥c tiÃªu lÃ¢u dÃ i cá»§a CÆ°Æ¡ng lÄ©nh xÃ¢y dá»±ng Ä‘áº¥t nÆ°á»›c trong thá»i ká»³ quÃ¡ Ä‘á»™ lÃªn chá»§ nghÄ©a xÃ£ há»™i","Má»¥c tiÃªu tá»•ng quÃ¡t cá»§a CÆ°Æ¡ng lÄ©nh nÄƒm 1991","Má»¥c tiÃªu cáº¥p thiáº¿t cá»§a Chiáº¿n lÆ°á»£c á»•n Ä‘á»‹nh vÃ  phÃ¡t triá»ƒn kinh táº¿- xÃ£ há»™i Ä‘áº¿n nÄƒm 2000","Má»¥c tiÃªu quan trá»ng cá»§a Chiáº¿n lÆ°á»£c á»•n Ä‘á»‹nh vÃ  phÃ¡t triá»ƒn kinh táº¿ xÃ£ há»™i Ä‘áº¿n nÄƒm 2000"], ans: 1 },
    // 20
    { type: 'mc', q: "Kháº³ng Ä‘á»‹nh nÃ o sau Ä‘Ã¢y lÃ  cá»§a Äáº¡i há»™i VII vá» lÄ©nh vá»±c kinh táº¿?", options: ["Ná»n kinh táº¿ bÆ°á»›c Ä‘áº§u chuyá»ƒn biáº¿n tÃ­ch cá»±c","Thu nháº­p quá»‘c dÃ¢n tÄƒng vÃ  giáº£i quyáº¿t Ä‘Æ°á»£c náº¡n Ä‘Ã³i","Nhá»‹p Ä‘á»™ phÃ¡t triá»ƒn kinh táº¿ cao","Cáº§n phÃ¡t triá»ƒn kinh táº¿ táº­p thá»ƒ vÃ  chá»§ trÆ°Æ¡ng xÃ¡c láº­p mÃ´i trÆ°á»ng thá»ƒ cháº¿"], ans: 0 },
    // 21
    { type: 'mc', q: "Äiá»n tiáº¿p vÃ o chá»— trá»‘ng: Äáº¡i há»™i Ä‘áº¡i biá»ƒu toÃ n quá»‘c láº§n thá»© VII Ä‘Ã£ kháº³ng Ä‘á»‹nh: \"Viá»‡t Nam muá»‘n lÃ  báº¡n vá»›i táº¥t cáº£ cÃ¡c nÆ°á»›c trong cá»™ng Ä‘á»“ng tháº¿ giá»›i, pháº¥n Ä‘áº¥u vÃ¬ ... vÃ  ...\"", options: ["Äá»™c láº­p - tá»± do - háº¡nh phÃºc","HÃ²a bÃ¬nh - Ä‘á»™c láº­p - phÃ¡t triá»ƒn","HÃ²a bÃ¬nh - há»¯u nghá»‹ - phÃ¡t triá»ƒn","Äá»™c láº­p - hÃ²a bÃ¬nh - tá»± do"], ans: 1 },
    // 22
    { type: 'mc', q: "Káº¿ hoáº¡ch 5 nÄƒm 1991-1995 khÃ´ng cÃ³ ná»™i dung nÃ o sau Ä‘Ã¢y:", options: ["Äáº©y lÃ¹i vÃ  kiá»ƒm soÃ¡t láº¡m phÃ¡t","á»”n Ä‘á»‹nh phÃ¡t triá»ƒn vÃ  nÃ¢ng cao hiá»‡u quáº£ ná»n sáº£n xuáº¥t xÃ£ há»™i","BÆ°á»›c Ä‘áº§u táº¡o ra má»™t cÆ¡ cáº¥u kinh táº¿ há»£p lÃ½","Báº¯t Ä‘áº§u cÃ³ tÃ­ch lÅ©y tá»« ná»™i bá»™ ná»n kinh táº¿."], ans: 2 },
    // 23
    { type: 'mc', q: "Äiá»n tá»« cÃ²n thiáº¿u vÃ o chá»— trá»‘ng sau: â€œláº¥y liÃªn minh giai cáº¥p..., giai cáº¥p ... vÃ  ... lÃ m ná»n táº£ng do Äáº£ng CÃ´ng sáº£n lÃ£nh Ä‘áº¡o. Thá»±c hiÃªn Ä‘á»§ quyá»n lÃ m chá»§ cá»§a nhÃ¢n dÃ¢nâ€", options: ["cÃ´ng nhÃ¢n, Ä‘á»‹a chá»§, giai cáº¥p tiá»ƒu tÆ° sáº£n","Ä‘á»‹a chá»§, nÃ´ng dÃ¢n, giai cáº¥p trÃ­ thá»©c","cÃ´ng nhÃ¢n, nÃ´ng dÃ¢n, giai cáº¥p trÃ­ thá»©c","cÃ´ng nhÃ¢n, nÃ´ng dÃ¢n, táº§ng lá»›p trÃ­ thá»©c"], ans: 3 },
    // 24
    { type: 'mc', q: "Äáº¡i há»™i VII láº§n Ä‘áº§u tiÃªn thÃ´ng qua Chiáº¿n lÆ°á»£c á»•n Ä‘á»‹nh vÃ  phÃ¡t triá»ƒn KT-XH Ä‘áº¿n nÄƒm 2000, trong Ä‘Ã³ xÃ¡c Ä‘á»‹nh má»¥c tiÃªu tá»•ng quÃ¡t Ä‘áº¿n nÄƒm 2000 lÃ :", options: ["Ra khá»i khá»§ng hoáº£ng, á»•n Ä‘á»‹nh ná»n kinh táº¿ xÃ£ há»™i, pháº¥n Ä‘áº¥u tÃ¬nh tráº¡ng nÆ°á»›c nghÃ¨o vÃ  kÃ©m phÃ¡t triá»ƒn","Trá»Ÿ thÃ nh nÆ°á»›c Ä‘ang phÃ¡t triá»ƒn cÃ³ thu nháº­p trung bÃ¬nh tháº¥p, cÃ³ ná»n cÃ´ng nghiá»‡p hiá»‡n Ä‘áº¡i phÃ¡t triá»ƒn","Äá»•i má»›i cÆ¡ cháº¿ quáº£n lÃ½, xÃ³a bá» cÆ¡ cháº¿ táº­p trung quan liÃªu, hÃ nh chÃ­nh, bao cáº¥p, chuyá»ƒn sang háº¡ch toÃ¡n, kinh doanh, káº¿t há»£p káº¿ hoáº¡ch vá»›i thá»‹ trÆ°á»ng","Äá»•i má»›i cÆ¡ cháº¿ quáº£n lÃ½ kinh táº¿, giáº£i quyáº¿t nhá»¯ng váº¥n Ä‘á» cáº¥p bÃ¡ch vá» phÃ¢n phá»‘i lÆ°u thÃ´ng"], ans: 0 },
    // 25
    { type: 'mc', q: "Nháº­n Ä‘á»‹nh nÃ o sau Ä‘Ã¢y khÃ´ng Ä‘Ãºng khi nÃ³i vá» Äáº¡i há»™i VII?", options: ["Coi nÃ´ng nghiá»‡p lÃ  máº·t tráº­n hÃ ng Ä‘áº§u vÃ  cÃ³ cÃ¡ch nhÃ¬n toÃ n diá»‡n","Táº¡o Ä‘iá»u kiá»‡n cho má»i ngÆ°á»i cÃ³ cuá»™c sá»‘ng áº¥m no háº¡nh phÃºc","Cáº§n thiáº¿t phÃ¡t triá»ƒn kinh táº¿ táº­p thá»ƒ.","HÃ¬nh thÃ nh ná»n kinh táº¿ hÃ ng hÃ³a thÃ nh pháº§n, váº­n Ä‘á»™ng theo cÆ¡ cháº¿ thá»‹ trÆ°á»ng, cÃ³ sá»± quáº£n lÃ½ cá»§a NhÃ  nÆ°á»›c, theo Ä‘á»‹nh hÆ°á»›ng xÃ£ há»™i chá»§ nghÄ©a"], ans: 2 },
    // 26
    { type: 'mc', q: "ÄÃ¢u lÃ  quan Ä‘iá»ƒm trong Äáº¡i hÃ´i Äáº¡i biá»ƒu toÃ n quá»‘c láº§n thá»© VII cá»§a Äáº£ng CÃ´ng sáº£n Viá»‡t Nam?", options: ["Äáº£ng gáº¯n liá»n vá»›i viá»‡c xÃ¢y dá»±ng vÃ  thá»±c hiá»‡n tháº¯ng lá»£i CÆ°Æ¡ng lÄ©nh, chiáº¿n lÆ°á»£c vÃ  cÃ´ng cuá»™c Ä‘á»•i má»›i","VÃ¢n dá»¥ng quan Ä‘iá»ƒm cá»§a Lenin coi ná»n kinh táº¿ cÃ³ cÆ¡ cáº¥u nhiá»u thÃ nh pháº§n vÃ  lÃ  má»™t Ä‘áº·c trÆ°ng cá»§a thá»i ká»³ quÃ¡ Ä‘á»™","Theo quy luáº­t vá» sá»± phÃ¹ há»£p giá»¯a quan há»‡ sáº£n xuáº¥t vá»›i tÃ­nh cháº¥t vÃ  trÃ¬nh Ä‘á»™ cá»§a lá»±c lÆ°á»£ng sáº£n xuáº¥t","CÃ´ng nghiá»‡p hÃ³a, hiá»‡n Ä‘áº¡i hÃ³a lÃ  sá»± nghiá»‡p cá»§a toÃ n dÃ¢n, cá»§a má»i thÃ nh pháº§n kinh táº¿, trong Ä‘Ã³ kinh táº¿ nhÃ  nÆ°á»›c lÃ  chá»§ Ä‘áº¡o"], ans: 0 },
    // 27
    { type: 'mc', q: "Äáº¡i hÃ´i Äáº¡i biá»ƒu toÃ n quá»‘c láº§n thá»© VII cá»§a Äáº£ng CÃ´ng sáº£n Viá»‡t Nam Ä‘Ã£ Ä‘á» ra bao nhiÃªu phÆ°Æ¡ng hÆ°á»›ng trong CÆ°Æ¡ng lÄ©nh?", options: ["4","5","6","7"], ans: 3 },
    // 28
    { type: 'mc', q: "ÄÃ¢u khÃ´ng pháº£i lÃ  váº¥n Ä‘á» quan trá»ng mÃ  HÃ´i nghá»‹ láº§n thá»© ba cá»§a Äáº¡i há»™i VII Ä‘Ã£ tháº£o luáº­n?", options: ["TÃ¬nh hÃ¬nh tháº¿ giá»›i vÃ  chÃ­nh sÃ¡ch Ä‘á»‘i ngoáº¡i","Cá»§ng cá»‘ quá»‘c phÃ²ng, giá»¯ vá»¯ng an ninh quá»‘c gia","Äá»•i má»›i vÃ  chá»‰nh Ä‘á»‘n Äáº£ng","Äa dáº¡ng hÃ³a vÃ  báº£o tá»“n vÄƒn hÃ³a nÆ°á»›c nhÃ "], ans: 3 },
    // 29
    { type: 'mc', q: "ÄÃ¢u lÃ  3 ná»™i dung tiáº¿n hÃ nh Ä‘á»•i má»›i Ä‘Æ°á»£c Äáº¡i hÃ´i Äáº¡i biá»ƒu toÃ n quá»‘c láº§n thá»© VII cá»§a Äáº£ng CÃ´ng sáº£n Viá»‡t Nam Ä‘á» cáº­p Ä‘áº¿n?", options: ["quá»‘c phÃ²ng, an ninh, Ä‘á»‘i ngoáº¡i","vÄƒn hÃ³a, kinh táº¿, chÃ­nh trá»‹","Ä‘á»‘i ngoáº¡i, xÃ£ hÃ´i, vÄƒn hÃ³a","vÄƒn hÃ³a, quá»‘c phÃ²ng, an ninh"], ans: 0 },
    // 30
    { type: 'mc', q: "ÄÃ¢u khÃ´ng pháº£i lÃ  nÃ´i dung vÄƒn hÃ³a trong Äáº¡i há»™i Äáº¡i biá»ƒu toÃ n quá»‘c láº§n thá»© VII cá»§a Äáº£ng CÃ´ng sáº£n Viá»‡t Nam?", options: ["Káº¿ thá»«a vÃ  phÃ¡t huy nhá»¯ng truyá»n thá»‘ng vÄƒn hoÃ¡ tá»‘t Ä‘áº¹p cá»§a táº¥t cáº£ cÃ¡c dÃ¢n tá»™c trong nÆ°á»›c, tiáº¿p thu nhá»¯ng tinh hoa vÄƒn hoÃ¡ nhÃ¢n loáº¡i","Sá»± nghiá»‡p vÄƒn hÃ³a, giÃ¡o dá»¥c pháº£i Ä‘Æ°á»£c tiáº¿p tá»¥c phÃ¡t triá»ƒn vÃ  nÃ¢ng cao cháº¥t lÆ°á»£ng","XÃ¢y dá»±ng Ä‘áº¥t nÆ°á»›c cÃ³ ná»n vÄƒn hÃ³a tiÃªn tiáº¿n, Ä‘Ã¢m Ä‘Ã  báº£n sáº¯c dÃ¢n tá»™c","Láº¥y chá»§ nghÄ©a MÃ¡c-LÃªnin, tÆ° tÆ°á»Ÿng Há»“ ChÃ­ Minh lÃ  ná»n táº£ng trong Ä‘á»i sá»‘ng tá»‰nh tháº§n xÃ£ há»™i."], ans: 1 },
    // 31
    { type: 'mc', q: "Äiá»n tá»« cÃ²n thiáº¿u vÃ o chá»— trá»‘ng Ä‘á»ƒ táº¡o thÃ nh má»™t má»‡nh Ä‘á» Ä‘Ãºng: â€œVÄƒn hÃ³a trong Äáº¡i hÃ´i Äáº¡i biá»ƒu toÃ n quá»‘c láº§n thá»© VII cá»§a Äáº£ng CÃ´ng sáº£n Viá»‡t Nam máº·c dÃ¹ Ä‘Æ°á»£c ... nhÆ°ng chÆ°a Ä‘Æ°á»£c...\"", options: ["táº­p trung phÃ¡t triá»ƒn, nhÆ° Ã½ muá»‘n","quan tÃ¢m phÃ¡t triá»ƒn, xem lÃ  váº¥n Ä‘á» trá»ng tÃ¢m","quan tÃ¢m phÃ¡t triá»ƒn, xem lÃ  váº¥n Ä‘á» Ä‘Ã¡ng quan ngáº¡i","táº­p trung phÃ¡t triá»ƒn, xem lÃ  váº¥n Ä‘á» trá»ng tÃ¢m"], ans: 1 },
    // 32
    { type: 'fitb', q: "Äáº¿n cuá»‘i nÄƒm \_\_\_\_\_, Viá»‡t Nam cÃ³ quan há»‡ ngoáº¡i giao vá»›i 160 nÆ°á»›c.", correctAnswer: "1995" },
    // 33
    { type: 'mc', q: "Äáº¡i há»™i VII há»p trong bá»‘i cáº£nh nÃ o cá»§a há»‡ thá»‘ng XHCN tháº¿ giá»›i?", options: ["CNXH tháº¿ giá»›i sá»¥p Ä‘á»•.","CNXH tháº¿ giá»›i phÃ¡t triá»ƒn nhanh chÃ³ng.","CNXH tháº¿ giá»›i má»›i hÃ¬nh thÃ nh.","CNXH tháº¿ giá»›i chÆ°a hÃ¬nh thÃ nh"], ans: 0 },
    // 34
    { type: 'mc', q: "Äáº¡i há»™i VII Ä‘Ã£ thÃ´ng qua CÆ°Æ¡ng lÄ©nh chÃ­nh trá»‹ láº§n thá»© máº¥y cá»§a Äáº£ng, vÃ  Ä‘Ã³ lÃ  cÆ°Æ¡ng lÄ©nh nÃ o?", options: ["Láº§n thá»© 4, CÆ°Æ¡ng lÄ©nh 1991.","Láº§n thá»© 5, CÆ°Æ¡ng lÄ©nh 1991.","Láº§n thá»© 6, CÆ°Æ¡ng lÄ©nh 1991.","Láº§n thá»© 7, CÆ°Æ¡ng lÄ©nh 1991."], ans: 0 },
    // 35
    { type: 'mc', q: "Äáº·c trÆ°ng vá» chÃ­nh trá»‹ cá»§a CNXH trong CÆ°Æ¡ng lÄ©nh 1991 lÃ  gÃ¬?", options: ["Giai cáº¥p cÃ´ng nhÃ¢n lÃ m chá»§.","Giai cáº¥p nÃ´ng dÃ¢n lÃ m chá»§.","Giai cáº¥p tÆ° sáº£n lÃ m chá»§.","NhÃ¢n dÃ¢n lao Ä‘á»™ng lÃ m chá»§."], ans: 3 },
    // 36
    { type: 'mc', q: "Äáº·c trÆ°ng vá» kinh táº¿ cá»§a CNXH trong CÆ°Æ¡ng lÄ©nh 1991 lÃ  gÃ¬?", options: ["Kinh táº¿ phÃ¡t triá»ƒn toÃ n diá»‡n.","Kinh táº¿ thá»‹ trÆ°á»ng.","Kinh táº¿ phÃ¡t triá»ƒn cao.","Kinh táº¿ phÃ¡t triá»ƒn á»•n Ä‘á»‹nh"], ans: 2 },
    // 37
    { type: 'fitb', q: "Má»¥c tiÃªu pháº¥n Ä‘áº¥u cao nháº¥t cá»§a Äáº£ng Ä‘Æ°á»£c Há»™i nghá»‹ giá»¯a nhiá»‡m ká»³ (1/1994) khÃ³a VII xÃ¡c Ä‘á»‹nh lÃ  \_\_\_\_\_ cá»§a con ngÆ°á»i.", correctAnswer: "háº¡nh phÃºc" },
];

const supplementaryQuestions = [
    { type: 'mc', q: "ÄÆ¡n vá»‹ tiá»n tá»‡ cá»§a Viá»‡t Nam lÃ  gÃ¬?", options:["Äá»“ng","VND","VNÄ","Táº¥t cáº£ Ä‘á»u Ä‘Ãºng"], ans: 3 },
    { type: 'fitb', q: "SÃ´ng dÃ i nháº¥t tháº¿ giá»›i lÃ  \_\_\_\_\_.", correctAnswer: "sÃ´ng Nile" },
    { type: 'mc', q: "NÃºi cao nháº¥t Viá»‡t Nam?", options:["Fansipan","PhÃº SÄ©","Everest"], ans: 0 },
    { type: 'fitb', q: "Thá»§ Ä‘Ã´ cá»§a Viá»‡t Nam lÃ  \_\_\_\_\_.", correctAnswer: "HÃ  Ná»™i" },
    { type: 'mc', q: "HÃ nh tinh nÃ o gáº§n Máº·t trá»i nháº¥t?", options:["TrÃ¡i Äáº¥t","Sao Thá»§y","Sao Há»a"], ans: 1 },
    { type: 'mc', q: "ChÃ¢u lá»¥c nÃ o lá»›n nháº¥t?", options:["ChÃ¢u Ã","ChÃ¢u Ã‚u","ChÃ¢u Phi"], ans: 0 },
    { type: 'fitb', q: "Sá»‘ Ï€ xáº¥p xá»‰ \_\_\_\_\_.", correctAnswer: "3.14" },
    { type: 'mc', q: "Máº·t trá»i lÃ  gÃ¬?", options:["HÃ nh tinh","Sao","Nguyá»‡t"], ans: 1 },
    { type: 'mc', q: "2*3 = ?", options:["5","6","7"], ans: 1 },
    { type: 'mc', q: "MÃ u cá»§a báº§u trá»i?", options:["Xanh","Äá»","VÃ ng"], ans: 0 },
    { type: 'mc', q: "VÄƒn Miáº¿u - Quá»‘c Tá»­ GiÃ¡m Ä‘Æ°á»£c xÃ¢y dá»±ng vÃ o triá»u Ä‘áº¡i nÃ o?", options:["LÃ½","Tráº§n","Há»“","LÃª"], ans: 0 },
    { type: 'mc', q: "Äáº¡i dÆ°Æ¡ng lá»›n nháº¥t trÃªn tháº¿ giá»›i?", options:["ThÃ¡i BÃ¬nh DÆ°Æ¡ng","Äáº¡i TÃ¢y DÆ°Æ¡ng","áº¤n Äá»™ DÆ°Æ¡ng"], ans: 0 },
    { type: 'fitb', q: "Tá»•ng thá»‘ng Ä‘áº§u tiÃªn cá»§a Hoa Ká»³ lÃ  \_\_\_\_\_.", correctAnswer: "George Washington" },
];

// Gá»™p vÃ  Ä‘áº£m báº£o Ä‘á»§ 50 cÃ¢u há»i (2 báº£ng * 25 Ã´)
let masterQuestions = [...officialQuestions];
if (masterQuestions.length < 50) {
    masterQuestions = masterQuestions.concat(supplementaryQuestions);
}
while (masterQuestions.length < 50) {
    masterQuestions = masterQuestions.concat(officialQuestions.slice(0, 50 - masterQuestions.length));
}

/* --- Háº°NG Sá» BOARD SIZE --- */
const BOARD_SIZE = 5;


/* --- táº¡o 2 báº£ng 5x5 --- */
function createBoard(boardId) {
    const board = document.getElementById(boardId);
    const labels = ['A','B','C','D','E']; 

    board.appendChild(document.createElement('div')); // gÃ³c
    for (let j = 1; j <= BOARD_SIZE; j++) {
        const label = document.createElement('div');
        label.className = 'label';
        label.textContent = j;
        board.appendChild(label);
    }

    for (let i = 0; i < BOARD_SIZE; i++) {
        const rowLabel = document.createElement('div');
        rowLabel.className = 'label';
        rowLabel.textContent = labels[i];
        board.appendChild(rowLabel);

        for (let j = 0; j < BOARD_SIZE; j++) {
            const cell = document.createElement('div');
            cell.className = 'cell';
            const index = `${labels[i]}${j+1}`;
            cell.dataset.index = index;
            cell.dataset.boardId = boardId; 
            cell.dataset.hasQuestion = 'false'; 
            cell.dataset.answered = 'false';
            
            const cellIndex = (i * BOARD_SIZE) + j; 
            let questionIndex;

            if (boardId === 'board1') {
                questionIndex = cellIndex;
            } else { 
                questionIndex = cellIndex + (BOARD_SIZE * BOARD_SIZE);
            }

            if (masterQuestions[questionIndex]) {
                cell.questionData = masterQuestions[questionIndex];
                cell.dataset.hasQuestion = 'true';
            }

            board.appendChild(cell);
        }
    }
}
createBoard('board1');
createBoard('board2');

/* --- popup color --- */
const popup = document.getElementById('popup');
const redBtn = document.querySelector('.color-btn.red');
const blueBtn = document.querySelector('.color-btn.blue');
let currentCell = null;

/* --- quiz overlay --- */
const quizPopup = document.getElementById('quizPopup');
const quizBox = document.getElementById('quizBox'); 
const quizQuestion = document.getElementById('quizQuestion');
const quizContent = document.getElementById('quizContent'); 
const backBtn = document.getElementById('backBtn');


/* --- add event listeners --- */
document.querySelectorAll('.cell').forEach(cell => {
    // single click: show color popup (to mark trÃºng/trÆ°á»£t manually)
    cell.addEventListener('click', (e) => {
        currentCell = e.currentTarget;
        const rect = currentCell.getBoundingClientRect();
        const left = rect.right + 8;
        let top = rect.top;
        if (left + 150 > window.innerWidth) {
            popup.style.left = (rect.left - 8 - 60) + 'px';
        } else {
            popup.style.left = left + 'px';
        }
        if (top + 50 > window.innerHeight) top = window.innerHeight - 60;
        popup.style.top = top + 'px';
        popup.style.display = 'flex';
    });

    // double click: open quiz overlay for that cell
    cell.addEventListener('dblclick', (e) => {
        currentCell = e.currentTarget;
        popup.style.display = 'none';
        quizBox.classList.remove('celebrate'); 
        
        // VÃ´ hiá»‡u hÃ³a double-click náº¿u Ã´ Ä‘Ã£ tráº£ lá»i Quiz
        if (currentCell.dataset.answered === 'true') {
             // alert('Ã” nÃ y Ä‘Ã£ Ä‘Æ°á»£c tráº£ lá»i.'); 
             return; 
        }
        
        // Loáº¡i bá» Ä‘Ã¡nh dáº¥u thá»§ cÃ´ng (náº¿u cÃ³) trÆ°á»›c khi má»Ÿ quiz
        currentCell.classList.remove('hit', 'miss'); 
        currentCell.textContent = ''; 
        openQuizForCell(currentCell);
    });
});

/* color buttons: Mark the board manually with a dot */
redBtn.addEventListener('click', () => {
    if (currentCell) {
        // Äáº£m báº£o khÃ´ng cÃ³ text content
        currentCell.textContent = ''; 
        // XÃ³a class cÅ©
        currentCell.classList.remove('miss');
        // ThÃªm class má»›i (hiá»ƒn thá»‹ cháº¥m trÃ²n qua CSS ::before)
        currentCell.classList.add('hit');
        // ÄÃ¡nh dáº¥u lÃ  Ä‘Ã£ Ä‘Æ°á»£c Ä‘Ã¡nh dáº¥u (khÃ´ng pháº£i lÃ  káº¿t quáº£ quiz)
        currentCell.dataset.answered = 'false'; 
    }
    popup.style.display = 'none';
});
blueBtn.addEventListener('click', () => {
    if (currentCell) {
        currentCell.textContent = ''; 
        currentCell.classList.remove('hit');
        currentCell.classList.add('miss');
        currentCell.dataset.answered = 'false'; 
    }
    popup.style.display = 'none';
});

// click outside popup -> hide
window.addEventListener('click', (e) => {
    if (!popup.contains(e.target) && !e.target.classList.contains('cell') && !e.target.closest('.color-btn')) {
        popup.style.display = 'none';
    }
});

/* --- quiz functions --- */
function openQuizForCell(cell) {
    let data;

    if (cell.dataset.hasQuestion === 'true' && cell.questionData) {
        data = cell.questionData;
    } else {
        alert(`Ã” ${cell.dataset.index} chÆ°a Ä‘Æ°á»£c gÃ¡n cÃ¢u há»i cá»‘ Ä‘á»‹nh.`);
        return;
    }

    quizQuestion.textContent = data.q;
    quizContent.innerHTML = '';
    
    if (data.type === 'mc') {
        renderMultipleChoice(data);
    } else if (data.type === 'fitb') {
        renderFillInTheBlank(data);
    }

    quizPopup.style.display = 'flex';
}

function celebrate() {
    quizBox.classList.add('celebrate');
    setTimeout(() => quizBox.classList.remove('celebrate'), 500);
}

// Cáº­p nháº­t Ã´ trÃªn báº£ng sau khi tráº£ lá»i
function updateCellOnAnswer(isCorrect) {
    if (currentCell) {
        // 1. ÄÃ¡nh dáº¥u lÃ  Ä‘Ã£ tráº£ lá»i Quiz (Ä‘á»ƒ vÃ´ hiá»‡u hÃ³a double-click sau nÃ y)
        currentCell.dataset.answered = 'true'; 
        
        // 2. KHÃ”NG Äá»”I MÃ€U GÃŒ Cáº¢ (CHá»ˆ XÃ“A ÄÃNH Dáº¤U CÅ¨ Náº¾U CÃ“)
        currentCell.classList.remove('hit', 'miss'); 
        currentCell.textContent = '';
    }
}


function renderMultipleChoice(data) {
    data.options.forEach((opt, idx) => {
        const o = document.createElement('div');
        o.className = 'option';
        o.textContent = opt;
        o.dataset.idx = idx;
        
        o.addEventListener('click', (e) => {
            
            const allOptions = Array.from(quizContent.children);
            allOptions.forEach(ch => ch.style.pointerEvents = 'none');
            
            const selectedIndex = Number(e.currentTarget.dataset.idx);
            let isCorrect = selectedIndex === data.ans;
            
            // Highlight Ä‘Ã¡p Ã¡n Ä‘Ãºng
            allOptions.forEach(ch => {
                if (Number(ch.dataset.idx) === data.ans) {
                    ch.classList.add('correct');
                }
            });
            
            // Highlight Ä‘Ã¡p Ã¡n SAI
            if (!isCorrect) {
                e.currentTarget.classList.add('wrong');
            } else {
                celebrate(); 
            }

            // Cáº­p nháº­t Ã´ trÃªn báº£ng: KHÃ”NG Äá»”I MÃ€U, chá»‰ Ä‘Ã¡nh dáº¥u lÃ  Ä‘Ã£ tráº£ lá»i
            updateCellOnAnswer(isCorrect); 
        });
        quizContent.appendChild(o);
    });
}

function renderFillInTheBlank(data) {
    const input = document.createElement('input');
    input.type = 'text';
    input.className = 'fitb-input';
    input.placeholder = 'Nháº­p cÃ¢u tráº£ lá»i cá»§a báº¡n...';
    
    const button = document.createElement('button');
    button.className = 'fitb-btn';
    button.textContent = 'Kiá»ƒm tra';

    const feedback = document.createElement('div');
    feedback.className = 'fitb-feedback';
    
    quizContent.appendChild(input);
    quizContent.appendChild(button);
    quizContent.appendChild(feedback);

    let answered = false;
    
    button.addEventListener('click', () => {
        if (answered) return; 

        const normalize = (text) => text.toLowerCase().replace(/[.,\/#!$%\^&\*;:{}=\-_`~()]/g,"").replace(/\s{2,}/g," ").trim();

        const userAnswer = normalize(input.value);
        const correctAnswer = normalize(data.correctAnswer);
        
        let isCorrect = (userAnswer === correctAnswer);

        input.disabled = true;
        button.style.pointerEvents = 'none';
        answered = true;

        if (isCorrect) {
            feedback.innerHTML = 'CHÃNH XÃC! ğŸ‰âœ¨';
            feedback.style.color = '#8cd179';
            celebrate();
            // Cáº­p nháº­t Ã´ trÃªn báº£ng: KHÃ”NG Äá»”I MÃ€U, chá»‰ Ä‘Ã¡nh dáº¥u lÃ  Ä‘Ã£ tráº£ lá»i
            updateCellOnAnswer(true); 
        } else {
            feedback.innerHTML = `SAI. ÄÃ¡p Ã¡n Ä‘Ãºng lÃ : <strong>${data.correctAnswer}</strong>`;
            feedback.style.color = '#ff7b7b';
            // Cáº­p nháº­t Ã´ trÃªn báº£ng: KHÃ”NG Äá»”I MÃ€U, chá»‰ Ä‘Ã¡nh dáº¥u lÃ  Ä‘Ã£ tráº£ lá»i
            updateCellOnAnswer(false); 
        }
    });

    // Cho phÃ©p nháº¥n Enter Ä‘á»ƒ kiá»ƒm tra
    input.addEventListener('keypress', (e) => {
        if (e.key === 'Enter' && !answered) {
            button.click();
        }
    });
}

// back button: close quiz overlay and return to board (cell remains unchanged)
backBtn.addEventListener('click', () => {
    quizPopup.style.display = 'none';
});
</script>
</body>
</html>